<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="icon" type="image/svg+xml" href="/favicon.svg" />
    <title>Abyss Survivors</title>
    <style>
      body { 
          margin: 0; 
          overflow: hidden; 
          background-color: #001e36; 
          color: white; 
          font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
          cursor: crosshair; /* Global crosshair cursor */
      }
      canvas { display: block; cursor: crosshair; }
      #ui-layer { position: absolute; top: 0; left: 0; width: 100%; height: 100%; pointer-events: none; cursor: crosshair; }
      .ui-element { position: absolute; pointer-events: auto; }
      
      /* Stats Area */
      #stats { 
         display: none; /* Replaced by individual elements */
      }
      
      #score-container {
          position: absolute;
          bottom: 20px; right: 100px;
          font-size: 24px; font-weight: bold;
          text-shadow: 2px 2px 2px black;
          color: #fff;
      }

      /* HP Bar */
      #hp-bar-container {
          width: 300px; height: 25px; 
          background: #333; border: 2px solid #555; 
          border-radius: 4px; overflow: hidden;
          position: absolute;
          top: 20px; left: 50%;
          transform: translateX(-50%);
          box-shadow: 0 0 10px rgba(0,0,0,0.5);
      }
      #hp-bar { width: 100%; height: 100%; background: #ff4444; transition: width 0.2s; }
      #hp-text { 
          position: absolute; top: 0; left: 0; width: 100%; height: 100%; 
          display: flex; align-items: center; justify-content: center; 
          font-size: 12px; text-shadow: 1px 1px 1px black; 
      }
      
      /* Boss HP Bar */
      #boss-hp-bar-container {
          width: 300px; height: 25px; 
          background: #333; border: 2px solid #9c27b0; 
          border-radius: 4px; overflow: hidden;
          position: absolute;
          top: 55px; left: 50%;
          transform: translateX(-50%);
          box-shadow: 0 0 10px rgba(156, 39, 176, 0.5);
      }

      /* XP Bar */
      #xp-bar-container { 
          bottom: 10px; left: 20%; width: 60%; height: 10px; /* Narrower, thinner, lower */
          background: #222; border: 1px solid #444; border-radius: 5px; overflow: hidden; 
          box-shadow: 0 0 10px rgba(0,0,0,0.5); 
      }
      #xp-bar { width: 0%; height: 100%; background: linear-gradient(90deg, #4caf50, #8bc34a); transition: width 0.2s; } /* Greenish */

      /* Depth Meter V2 */
      #depth-meter-container {
          position: absolute;
          top: 20px; bottom: 20px; left: 20px; /* Symmetric top/bottom */
          width: 30px; 
          background: linear-gradient(to bottom, #00bcd4 0%, #000044 100%);
          border: 2px solid #fff;
          border-radius: 4px; 
          overflow: visible; 
          box-shadow: 0 0 10px rgba(0,0,0,0.5);
      }
      
      /* The indicator sub */
      #depth-cursor {
          position: absolute;
          top: 0%; left: 50%;
          transform: translate(-50%, -50%);
          font-size: 20px;
          transition: top 0.1s linear;
          text-shadow: 0 0 5px black;
      }
      
      /* Markers */
      .depth-marker {
          position: absolute;
          right: -45px;
          font-size: 12px;
          color: #fff;
          font-weight: bold;
          transform: translateY(-50%);
          text-align: left;
          width: 40px;
          text-shadow: 1px 1px 2px black;
      }
      .depth-tick {
          position: absolute;
          left: 0; width: 100%; height: 1px;
          background: rgba(255,255,255,0.5);
      }
      
      #depth-label-title {
          position: absolute;
          top: -20px; left: 50%;
          transform: translateX(-50%);
          font-size: 12px; font-weight: bold; color: #00bcd4;
          text-shadow: 1px 1px 1px black;
          padding-bottom: 5px;
      }

      /* Inventory */
      #inventory-container {
        top: 20px; right: 20px;
        display: flex;
        flex-direction: row;
        gap: 10px;
      }
      #inventory {
        display: grid;
        grid-template-columns: repeat(10, 40px);
        gap: 10px;
        direction: rtl; /* Fill from right to left */
      }
      .inv-item {
        width: 40px; height: 40px;
        background: rgba(0,0,0,0.6);
        border: 1px solid #555;
        border-radius: 6px;
        display: flex;
        align-items: center;
        justify-content: center;
        position: relative;
        box-shadow: 0 0 5px rgba(0,0,0,0.5);
        direction: ltr; /* Keep item content left-to-right */
      }
      .inv-item.maxed {
        background: linear-gradient(135deg, rgba(255, 215, 0, 0.3), rgba(255, 193, 7, 0.3));
        border: 2px solid #ffd700;
        box-shadow: 0 0 10px rgba(255, 215, 0, 0.6), 0 0 5px rgba(0,0,0,0.5);
      }
      .inv-icon { font-size: 24px; }
      .inv-rank { 
          position: absolute; bottom: -4px; right: -4px; 
          font-size: 11px; background: #000; color: #fff; 
          padding: 1px 4px; border-radius: 4px; border: 1px solid #333;
      }
      .inv-max-tag {
          position: absolute; top: -6px; right: -6px;
          font-size: 8px; font-weight: bold;
          background: linear-gradient(135deg, #ffd700, #ffb300);
          color: #000;
          padding: 2px 4px; border-radius: 3px;
          border: 1px solid #ffd700;
          box-shadow: 0 0 5px rgba(255, 215, 0, 0.8);
          text-transform: uppercase;
          letter-spacing: 0.5px;
      }

      /* Minigame */
      #minigame-gauge-container {
          width: 600px; height: 50px;
          background: #222;
          border: 4px solid #fff;
          border-radius: 25px;
          overflow: hidden;
          position: relative;
          margin: 20px 0;
          box-shadow: 0 0 20px rgba(255,255,255,0.2);
      }
      #minigame-gauge { width: 100%; height: 100%; position: relative; }
      .gauge-zone { height: 100%; position: absolute; top: 0; }
      .zone-common { width: 100%; background: #4caf50; left: 0; }
      .zone-rare-left { width: 3.5%; background: #9c27b0; left: 44.75%; }
      .zone-rare-right { width: 3.5%; background: #9c27b0; left: 51.75%; }
      .zone-legendary { width: 3.5%; background: #ff9800; left: 48.25%; }
      
      #gauge-cursor {
          width: 4px; height: 100%;
          background: #fff;
          position: absolute;
          top: 0; left: 0;
          box-shadow: 0 0 10px #fff;
      }

      /* Debug Menu */
      #debug-menu {
          pointer-events: auto;
          cursor: default;
      }
      #debug-menu button {
          cursor: pointer;
      }

      /* Menus */
      .fullscreen-menu {
        display: none;
        position: absolute;
        top: 0; left: 0; width: 100%; height: 100%;
        background: rgba(0, 0, 0, 0.85);
        justify-content: center;
        align-items: center;
        pointer-events: auto;
        flex-direction: column;
        z-index: 100;
        backdrop-filter: blur(5px);
      }
      
      /* Upgrade Menu */
      #upgrade-options {
          display: flex;
          flex-direction: row;
          gap: 25px;
          margin-top: 30px;
      }
      
      @keyframes pulse-glow {
        0% { box-shadow: 0 0 20px rgba(255,255,255,0.1); }
        50% { box-shadow: 0 0 30px rgba(255,255,255,0.3); }
        100% { box-shadow: 0 0 20px rgba(255,255,255,0.1); }
      }
      
      .upgrade-card {
        animation: pulse-glow 2s infinite;
        background: linear-gradient(180deg, #003366 0%, #001e36 100%);
        border: 2px solid #444;
        padding: 25px;
        width: 220px;
        height: 320px;
        cursor: pointer; /* Keep pointer for interactables */
        text-align: center;
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: flex-start;
        transition: all 0.2s;
        border-radius: 12px;
        position: relative;
        box-shadow: 0 10px 20px rgba(0,0,0,0.5);
      }
      .upgrade-card:hover {
        transform: translateY(-10px) scale(1.02);
        box-shadow: 0 15px 30px rgba(0,0,0,0.6);
        border-color: #fff;
        z-index: 10;
      }
      .upgrade-icon { font-size: 72px; margin-bottom: 15px; filter: drop-shadow(0 0 10px rgba(255,255,255,0.2)); }
      .upgrade-card h3 { margin: 10px 0; font-size: 1.2em; color: #fff; }
      .upgrade-card p { font-size: 0.9em; color: #ccc; line-height: 1.4; }
      
      .rarity-badge {
          margin-top: auto;
          padding: 6px 12px;
          border-radius: 20px;
          font-size: 12px;
          font-weight: bold;
          color: #000;
          text-transform: uppercase;
          letter-spacing: 1px;
      }
      /* Rarities */
      .rarity-common { border-color: #4caf50; box-shadow: 0 0 15px rgba(76, 175, 80, 0.3); }
      .rarity-common .rarity-badge { background: #4caf50; color: #fff; text-shadow: 1px 1px 0 rgba(0,0,0,0.5); }
      
      .rarity-rare { border-color: #9c27b0; box-shadow: 0 0 20px rgba(156, 39, 176, 0.4); }
      .rarity-rare .rarity-badge { background: #9c27b0; color: white; box-shadow: 0 0 10px #9c27b0; }
      
      .rarity-legendary { border-color: #ff9800; box-shadow: 0 0 25px rgba(255, 152, 0, 0.5); }
      .rarity-legendary .rarity-badge { background: linear-gradient(45deg, #ff9800, #ff5722); color: white; box-shadow: 0 0 15px #ff9800; }

      h1 { font-size: 3em; margin-bottom: 10px; text-shadow: 0 0 20px rgba(0, 188, 212, 0.5); }
      
      /* Death Screen */
      #death-screen h1 { color: #ff4444; text-shadow: 0 0 20px rgba(255, 68, 68, 0.5); }
      .death-stat { font-size: 1.5em; margin: 8px 0; color: #ccc; }
      .death-stat span { color: #fff; font-weight: bold; }
      
      /* Victory Stats Layout */
      .victory-stats {
          display: flex;
          gap: 50px;
          justify-content: center;
          align-items: flex-start;
          margin: 20px 0;
          max-width: 1400px;
          margin-left: auto;
          margin-right: auto;
      }
      
      .stats-column {
          display: flex;
          flex-direction: column;
          min-width: 280px;
      }
      
      .stats-column h3 {
          font-size: 1.8em;
          margin-bottom: 10px;
          margin-top: 0;
          color: #fff;
          text-shadow: 0 0 10px rgba(0, 188, 212, 0.5);
      }
      
      .game-stat {
          margin: 4px 0 !important;
          font-size: 1.4em;
      }
      
      .enemy-kills-column {
          display: flex;
          flex-direction: column;
          min-width: 400px;
      }
      
      .enemy-kills-column h3 {
          font-size: 1.8em;
          margin-bottom: 10px;
          margin-top: 0;
          color: #fff;
          text-shadow: 0 0 10px rgba(0, 188, 212, 0.5);
      }
      
      .enemy-kills-grid {
          display: flex;
          gap: 30px;
          flex-wrap: wrap;
      }
      
      .enemy-kills-subcolumn {
          display: flex;
          flex-direction: column;
          flex: 1;
          min-width: 180px;
      }
      
      .enemy-stat {
          margin: 4px 0 !important;
          font-size: 1.4em;
      }
      
      #restart-btn {
          margin-top: 30px;
          padding: 15px 40px;
          font-size: 24px;
          background: #00bcd4;
          color: #000;
          border: none;
          border-radius: 50px;
          cursor: pointer; /* Keep pointer for button */
          font-weight: bold;
          transition: all 0.2s;
          box-shadow: 0 0 20px rgba(0, 188, 212, 0.4);
      }
      #restart-btn:hover {
          transform: scale(1.1);
          background: #fff;
          box-shadow: 0 0 30px rgba(255, 255, 255, 0.6);
      }

      /* Settings Button */
      #settings-btn {
          position: absolute;
          bottom: 20px;
          right: 20px;
          width: 50px;
          height: 50px;
          background: rgba(0, 0, 0, 0.6);
          border: 2px solid #555;
          border-radius: 50%;
          cursor: pointer;
          display: flex;
          align-items: center;
          justify-content: center;
          font-size: 24px;
          color: #fff;
          transition: all 0.2s;
          z-index: 1000;
          pointer-events: auto;
          box-shadow: 0 0 10px rgba(0, 0, 0, 0.5);
      }
      #settings-btn:hover {
          background: rgba(0, 0, 0, 0.8);
          border-color: #00bcd4;
          transform: scale(1.1);
          box-shadow: 0 0 20px rgba(0, 188, 212, 0.5);
      }

       /* Settings Menu */
       #settings-menu {
           display: none;
           position: absolute;
           top: 0;
           left: 0;
           width: 100%;
           height: 100%;
           background: rgba(0, 0, 0, 0.85);
           justify-content: center;
           align-items: center;
           pointer-events: auto;
           flex-direction: column;
           z-index: 101;
           backdrop-filter: blur(5px);
       }
      #settings-menu h3 {
          margin: 0 0 30px 0;
          color: #00bcd4;
          text-align: center;
          font-size: 2.5em;
          text-shadow: 0 0 20px rgba(0, 188, 212, 0.5);
      }
      .settings-item {
          margin-bottom: 30px;
          min-width: 400px;
      }
      .settings-item label {
          display: block;
          color: #fff;
          margin-bottom: 12px;
          font-size: 18px;
          text-align: center;
      }
      .settings-item input[type="range"] {
          width: 100%;
          height: 8px;
          background: #333;
          border-radius: 4px;
          outline: none;
          -webkit-appearance: none;
      }
      .settings-item input[type="range"]::-webkit-slider-thumb {
          -webkit-appearance: none;
          appearance: none;
          width: 24px;
          height: 24px;
          background: #00bcd4;
          border-radius: 50%;
          cursor: pointer;
          box-shadow: 0 0 10px rgba(0, 188, 212, 0.5);
      }
      .settings-item input[type="range"]::-moz-range-thumb {
          width: 24px;
          height: 24px;
          background: #00bcd4;
          border-radius: 50%;
          cursor: pointer;
          border: none;
          box-shadow: 0 0 10px rgba(0, 188, 212, 0.5);
      }
      .settings-value {
          color: #00bcd4;
          font-weight: bold;
          text-align: center;
          margin-top: 10px;
          font-size: 20px;
      }
      .settings-item input[type="checkbox"] {
          display: none;
      }
      .settings-item .checkbox-label {
          display: flex;
          align-items: center;
          justify-content: center;
          gap: 12px;
          cursor: pointer;
          color: #fff;
          font-size: 18px;
      }
      .settings-item .checkbox-custom {
          width: 24px;
          height: 24px;
          background: #333;
          border: 2px solid #555;
          border-radius: 4px;
          position: relative;
          transition: all 0.2s;
          box-shadow: 0 0 5px rgba(0, 0, 0, 0.5);
      }
      .settings-item .checkbox-custom:hover {
          border-color: #00bcd4;
          box-shadow: 0 0 10px rgba(0, 188, 212, 0.3);
      }
      .settings-item input[type="checkbox"]:checked + .checkbox-custom {
          background: #00bcd4;
          border-color: #00bcd4;
          box-shadow: 0 0 10px rgba(0, 188, 212, 0.5);
      }
      .settings-item input[type="checkbox"]:checked + .checkbox-custom::after {
          content: '‚úì';
          position: absolute;
          top: 50%;
          left: 50%;
          transform: translate(-50%, -50%);
          color: #000;
          font-weight: bold;
          font-size: 16px;
      }
      #settings-close-btn {
          margin-top: 30px;
          padding: 15px 40px;
          font-size: 20px;
          background: #00bcd4;
          color: #000;
          border: none;
          border-radius: 50px;
          cursor: pointer;
          font-weight: bold;
          transition: all 0.2s;
          box-shadow: 0 0 20px rgba(0, 188, 212, 0.4);
      }
      #settings-close-btn:hover {
          transform: scale(1.1);
          background: #fff;
          box-shadow: 0 0 30px rgba(255, 255, 255, 0.6);
      }

       /* Esc Menu (Upgrades Display) */
       #esc-menu {
           display: none;
           position: absolute;
           top: 0;
           left: 0;
           width: 100%;
           height: 100%;
           background: rgba(0, 0, 0, 0.9);
           justify-content: flex-start;
           align-items: center;
           pointer-events: auto;
           flex-direction: column;
           z-index: 100;
           backdrop-filter: blur(5px);
           overflow-y: auto;
           padding: 15px 20px 10px 20px;
           box-sizing: border-box;
       }
       #esc-menu h3 {
           margin: 0 0 10px 0;
           color: #00bcd4;
           text-align: center;
           font-size: 2.2em;
           text-shadow: 0 0 20px rgba(0, 188, 212, 0.5);
       }
       #esc-menu-upgrades-container {
           max-width: 1600px;
           width: 100%;
           margin-bottom: 10px;
           padding: 0 20px;
       }
       .rarity-group {
           margin-bottom: 15px;
       }
       .rarity-group-title {
           font-size: 1.3em;
           font-weight: bold;
           margin-bottom: 8px;
           text-shadow: 0 0 10px rgba(0, 188, 212, 0.5);
       }
      .rarity-group-title.legendary {
          color: #ff9800;
      }
      .rarity-group-title.rare {
          color: #9c27b0;
      }
      .rarity-group-title.common {
          color: #4caf50;
      }
      .rarity-group-grid {
          display: grid;
          grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
          gap: 10px;
      }
      .esc-upgrade-card {
          background: linear-gradient(180deg, #003366 0%, #001e36 100%);
          border: 2px solid #444;
          padding: 10px;
          border-radius: 8px;
          display: flex;
          flex-direction: column;
          align-items: center;
          text-align: center;
          transition: all 0.2s;
          box-shadow: 0 3px 10px rgba(0,0,0,0.5);
          min-height: 120px;
      }
      .esc-upgrade-card:hover {
          transform: translateY(-3px);
          box-shadow: 0 6px 15px rgba(0,0,0,0.7);
      }
      .esc-upgrade-card.locked {
          opacity: 0.4;
          filter: grayscale(0.8);
      }
      .esc-upgrade-card.rarity-common {
          border-color: #4caf50;
          box-shadow: 0 0 10px rgba(76, 175, 80, 0.2);
      }
      .esc-upgrade-card.rarity-common.locked {
          border-color: #333;
          box-shadow: none;
      }
      .esc-upgrade-card.rarity-rare {
          border-color: #9c27b0;
          box-shadow: 0 0 12px rgba(156, 39, 176, 0.3);
      }
      .esc-upgrade-card.rarity-rare.locked {
          border-color: #333;
          box-shadow: none;
      }
      .esc-upgrade-card.rarity-legendary {
          border-color: #ff9800;
          box-shadow: 0 0 15px rgba(255, 152, 0, 0.4);
      }
      .esc-upgrade-card.rarity-legendary.locked {
          border-color: #333;
          box-shadow: none;
      }
      .esc-upgrade-icon {
          font-size: 26px;
          margin-bottom: 4px;
          filter: drop-shadow(0 0 8px rgba(255,255,255,0.2));
      }
      .esc-upgrade-card.locked .esc-upgrade-icon {
          filter: grayscale(1) drop-shadow(0 0 4px rgba(255,255,255,0.1));
      }
      .esc-upgrade-card h4 {
          margin: 3px 0 3px 0;
          font-size: 0.8em;
          color: #fff;
          line-height: 1.2;
      }
      .esc-upgrade-card.locked h4 {
          color: #888;
      }
      .esc-upgrade-card p {
          margin: 0 0 6px 0;
          font-size: 0.68em;
          color: #ccc;
          line-height: 1.3;
          flex-grow: 1;
      }
      .esc-upgrade-card.locked p {
          color: #666;
      }
      .esc-upgrade-rank {
          margin-top: auto;
          padding: 4px 8px;
          border-radius: 12px;
          font-size: 10px;
          font-weight: bold;
          color: #fff;
          background: rgba(0, 0, 0, 0.5);
      }
      .esc-upgrade-rank.maxed {
          background: linear-gradient(135deg, #ffd700, #ffb300);
          color: #000;
          box-shadow: 0 0 8px rgba(255, 215, 0, 0.6);
      }
      .esc-upgrade-card.rarity-common:not(.locked) .esc-upgrade-rank:not(.maxed) {
          background: rgba(76, 175, 80, 0.3);
      }
      .esc-upgrade-card.rarity-rare:not(.locked) .esc-upgrade-rank:not(.maxed) {
          background: rgba(156, 39, 176, 0.3);
      }
      .esc-upgrade-card.rarity-legendary:not(.locked) .esc-upgrade-rank:not(.maxed) {
          background: rgba(255, 152, 0, 0.3);
      }
      .esc-upgrade-card.locked .esc-upgrade-rank {
          background: rgba(50, 50, 50, 0.5);
          color: #666;
      }
       #esc-menu-close-btn {
           margin-top: 10px;
           padding: 12px 35px;
           font-size: 18px;
           background: #00bcd4;
           color: #000;
           border: none;
           border-radius: 50px;
           cursor: pointer;
           font-weight: bold;
           transition: all 0.2s;
           box-shadow: 0 0 20px rgba(0, 188, 212, 0.4);
       }
      #esc-menu-close-btn:hover {
          transform: scale(1.1);
          background: #fff;
          box-shadow: 0 0 30px rgba(255, 255, 255, 0.6);
      }
    </style>
  </head>
  <body>
    <div id="ui-layer">
      <!-- Depth Meter -->
      <div id="depth-meter-container">
          <!-- Ticks -->
          <div class="depth-tick" style="top: 0%"></div>
          <div class="depth-marker" style="top: 0%">0m</div>
          
          <div class="depth-tick" style="top: 25%"></div>
          <div class="depth-marker" style="top: 25%">250m</div>
          
          <div class="depth-tick" style="top: 50%"></div>
          <div class="depth-marker" style="top: 50%">500m</div>
          
          <div class="depth-tick" style="top: 75%"></div>
          <div class="depth-marker" style="top: 75%">750m</div>
          
          <div class="depth-tick" style="top: 100%"></div>
          <div class="depth-marker" style="top: 100%">1000m</div>

          <!-- Cursor -->
          <div id="depth-cursor">üü°</div> <!-- Simple sub icon -->
      </div>

      <div id="hp-bar-container" class="ui-element">
          <div id="hp-bar"></div>
          <div id="hp-text">100 / 100</div>
      </div>
      
      <div id="boss-hp-bar-container" class="ui-element" style="display:none;">
          <div id="boss-hp-bar" style="width:100%; height:100%; background:#9c27b0; transition:width 0.2s;"></div>
          <div id="boss-hp-text" style="position:absolute; top:0; left:0; width:100%; height:100%; display:flex; align-items:center; justify-content:center; font-size:12px; text-shadow:1px 1px 1px black;">KRAKEN: 5000 / 5000</div>
      </div>
      
      <div id="boss-phase-indicator" class="ui-element" style="display:none; position:absolute; top:90px; left:50%; transform:translateX(-50%); font-size:18px; font-weight:bold; text-shadow:2px 2px 4px black; color:#fff;">
          <span id="boss-phase-text">PHASE 1</span>
      </div>
      
      <div id="score-container" class="ui-element">
          Level: <span id="score">1</span>
      </div>
      
      <div id="inventory-container" class="ui-element">
          <div id="inventory">
             <!-- Inventory Items -->
          </div>
      </div>

      <div id="xp-bar-container" class="ui-element">
        <div id="xp-bar"></div>
      </div>
      
      <!-- Upgrade Menu -->
      <div id="upgrade-menu" class="fullscreen-menu">
          <h1>LEVEL UP!</h1>
          <div id="upgrade-options">
             <!-- Options injected here -->
          </div>
      </div>

      <!-- Minigame UI -->
      <div id="minigame-layer" class="fullscreen-menu">
          <h1>TREASURE FOUND!</h1>
          <div id="minigame-gauge-container">
              <div id="minigame-gauge">
                  <div class="gauge-zone zone-common"></div>
                  <div class="gauge-zone zone-rare-left"></div>
                  <div class="gauge-zone zone-rare-right"></div>
                  <div class="gauge-zone zone-legendary"></div>
                  <div id="gauge-cursor"></div>
              </div>
          </div>
          <p>Press SPACE to stop!</p>
          <div id="minigame-reward" style="display:none; margin-top:20px; text-align:center;">
              <h2>UPGRADE!</h2>
              <div id="reward-content" style="display: flex; flex-direction: column; align-items: center; gap: 10px;">
                  <!-- Injected content -->
              </div>
          </div>
      </div>

      <!-- Debug Menu -->
      <div id="debug-menu" style="display:none; position:absolute; top:10px; left:10px; background:rgba(0,0,0,0.9); padding:20px; border:1px solid #fff; color:#fff; z-index:1001; max-height: 90vh; overflow-y: auto; pointer-events: auto;">
          <h3>Debug Menu</h3>
          <p>Press ` to toggle</p>
          
          <div style="margin-bottom: 20px;">
              <label>Depth (m): <span id="debug-depth-val">0</span></label>
              <input type="range" id="debug-depth-slider" min="0" max="1200" value="0" style="width:100%;">
          </div>

          <div style="margin-bottom: 20px;">
              <button id="debug-max-all-powerups" style="padding: 10px; cursor: pointer; width: 100%; background: #ffd700; color: #000; border: none; border-radius: 4px; font-weight: bold;">Max All Power-Ups</button>
          </div>

          <div style="margin-bottom: 20px;">
              <button id="debug-level-up" style="padding: 10px; cursor: pointer; width: 100%; background: #00bcd4; color: #000; border: none; border-radius: 4px; font-weight: bold;">Level Up</button>
          </div>

          <div style="margin-bottom: 20px; display: flex; gap: 8px;">
              <button id="debug-max-all-legendary" style="padding: 6px 10px; cursor: pointer; flex: 1; background: #ff9800; color: #000; border: none; border-radius: 4px; font-weight: bold; font-size: 12px;">Max All Legendary</button>
              <button id="debug-max-all-rare" style="padding: 6px 10px; cursor: pointer; flex: 1; background: #9c27b0; color: #fff; border: none; border-radius: 4px; font-weight: bold; font-size: 12px;">Max All Rare</button>
          </div>

          <div style="margin-bottom: 8px;">
              <label style="display: flex; align-items: center; gap: 10px;">
                  <input type="checkbox" id="debug-invulnerable" style="width: 20px; height: 20px;">
                  <span>Invulnerable</span>
              </label>
          </div>

          <div style="margin-bottom: 8px;">
              <label style="display: flex; align-items: center; gap: 10px;">
                  <input type="checkbox" id="debug-speed" style="width: 20px; height: 20px;">
                  <span>5x Speed</span>
              </label>
          </div>

          <div style="margin-bottom: 8px;">
              <label style="display: flex; align-items: center; gap: 10px;">
                  <input type="checkbox" id="debug-no-level-up" style="width: 20px; height: 20px;">
                  <span>Disable Level Up</span>
              </label>
          </div>

          <h4>Add Power Up</h4>
          <div id="debug-powerups" style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 5px;">
              <!-- Buttons injected here -->
          </div>
      </div>

      <!-- Death Screen -->
      <div id="death-screen" class="fullscreen-menu">
          <h1>Your sub imploded!</h1>
          <div class="death-stat">Max Depth: <span id="death-level">0m</span></div>
          <div class="death-stat">Final Level: <span id="death-level-value">1</span></div>
          <div class="death-stat">Final Score: <span id="death-score">0</span></div>
          <button id="restart-btn">DIVE AGAIN</button>
      </div>

      <!-- Settings Button -->
      <button id="settings-btn" class="ui-element" title="Settings">‚öôÔ∏è</button>

      <!-- Settings Menu -->
      <div id="settings-menu" class="ui-element">
          <h3>Settings</h3>
          <div class="settings-item">
              <label for="volume-slider">Master Volume</label>
              <input type="range" id="volume-slider" min="0" max="100" value="100" step="1">
              <div class="settings-value" id="volume-value">100%</div>
          </div>
          <div class="settings-item">
              <label for="ambient-sound-checkbox" class="checkbox-label">
                  <input type="checkbox" id="ambient-sound-checkbox" checked>
                  <span class="checkbox-custom"></span>
                  <span>Aquatic Ambience</span>
              </label>
          </div>
          <button id="settings-close-btn">RESUME (ESC)</button>
      </div>

      <!-- Esc Menu (Upgrades Display) -->
      <div id="esc-menu" class="ui-element">
          <h3>Upgrade Dictionarium</h3>
          <div id="esc-menu-upgrades-container">
              <!-- Upgrades will be populated here -->
          </div>
          <button id="esc-menu-close-btn">RESUME (ESC)</button>
      </div>
    </div>
    <canvas id="gameCanvas"></canvas>
    <script type="module" src="/src/main.ts"></script>
  </body>
</html>
